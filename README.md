**Практика ВК 2025**

Проект, выполненный в рамках летней практики ВК летом 2025 года. Цель
проекта – разработать модель бинарной классификации для предсказания пола пользователей социальной сети по данным
их активности (https://drive.google.com/drive/folders/1ItXW9eJbKVviIWQYb8dvKZ6Yvz9IfS_y?usp=drive_link ссылка где хранятся изначальные датасеты).

**Используемые** **библиотеки**

> • Pandas 
>
> • NumPy
>
> • scikit-learn

**Основные** **этапы** **работы**

> 1\. **Предобработка** **данных:** из исходных данных удалены
> неинформативные или несбалансированные признаки (например, request_ts
> , country_id , timezone_id ). Вместо идентификатора локации ( geo_id )
> использованы подробные географические данные из таблицы *geo_info*;
> аналогично обработаны поля HTTP-запросов. Категориальные поля
> операционной системы и браузера преобразованы методом one-hot
> encoding; признак region_id закодирован частотой (frequency encoding).
> Числовые признаки (например, компоненты URL запросов) нормализованы с
> помощью StandardScaler .
>
> 2\. **Разбиение** **данных** **на** **выборки:** обработанный датасет
> разделен на обучающую и контрольные выборки в соотношении
> **60/15/15/10**. 60% данных использовалось для обучения модели, 15% –
> валидационная выборка 1 для подбора гиперпараметра модели, еще 15% –
> валидационная выборка 2 для выбора оптимального порога классификации,
> и оставшиеся 10% отложены в качестве финальной тестовой выборки для
> оценки качества.
>
> 3\. **Обучение** **модели:** в качестве классификатора выбрана
> логистическая регрессия. Обучение модели проводилось методом
> градиентного спуска на обучающей выборке. На первой валидационной
> выборке перебирались различные значения гиперпараметра α (скорости
> обучения градиентного спуска), и по максимальному значению ROC AUC
> было выбрано оптимальное значение α. Итоговая модель (вектора весов)
> сохранена для последующего предсказания.
>
> 4\. **Выбор** **порога** **классификации:** вместо стандартного порога
> 0.5 был определен оптимальный порог вероятности для решения о классе.
> На второй валидационной выборке строилась ROC-кривая, и при помощи
> индекса Юдена (Youden’s J statistic) выбран порог, максимизирующий
> сумму чувствительности и специфичности классификатора. Этот порог
> используется для преобразования предсказанной вероятности в метку
> класса 0/1.
>
> 5\. **Оценка** **качества:** финальная оценка модели произведена на
> тестовой выборке (10% данных, не участвовавших в обучении). В качестве
> метрик использовались площадь под ROC-кривой (ROC AUC) и F1-мера. Модель продемонстрировала качество
> **ROC** **AUC** и **F1-score** на
> тестовых данных.
> 

**Использование** **модели**

После обучения модель логистической регрессии предоставляет метод
predict для предсказания пола новых пользователей. Метод predict
принимает три аргумента:

> • **users_df** – *pandas.DataFrame* с колонкой user_id , содержащий
> список пользователей, для которых необходимо сделать предсказание.
>
> • **id_array** – *numpy.ndarray* с идентификаторами пользователей для
> каждого события (строки) из тестовой выборки.
>
> • **sample_array** – *numpy.ndarray* с векторами признаков,
> соответствующими каждому элементу в id_array.

В процессе работы predict вычисляет вероятность принадлежности к классу
для каждого сэмпла из sample_array , группирует результаты по
user_id и усредняет вероятности для всех событий данного пользователя.
Затем полученная средняя вероятность сравнивается с ранее найденным
оптимальным порогом: если вероятность ≥ порога, прогнозируется класс 1,
иначе 0. Метод возвращает DataFrame (на основе users_df ) с добавленным
столбцом prediction , содержащим предсказанный пол пользователя (бинарная метка 0/1).

**Заключение**

Таким образом, в результат работы модели был оценен значениями полученных метрик: **ROC AUC = 0.72**, **F1 = 0.64**, их следует интерпретировать с учётом специфики данных. Большая часть запросов пользователей не содержит ярко выраженного «гендерного» сигнала — это, например могут быть, запросы вроде «погода», «курс доллара» и т.п.
Это фактически понижает достижимый потолок качества для модели классификации, обученной на этом датасете.
В этой постановке задачи **ROC AUC = 0.72** показывает, что модель заметно лучше случайного угадывания (0.5) и действительно улавливает статистические различия в поведении разных групп пользователей на совокупности запросов. Значение **F1 = 0.64** демонстрирует баланс между полнотой и точностью на фоне большого числа «нейтральных» запросов, по которым модель ожидаемо ошибается чаще, так как сигнал пола в них либо очень слабый, либо практически отсутствует.
